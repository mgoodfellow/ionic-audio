function ionAudioTrack(n,i){function o(n,i,o,t){t.hasOwnProgressBar=i.find("ion-audio-progress-bar").length>0}function t(o,t){var r=this,a=function(i,o){i&&i.url&&(i.progress=0,i.status=0,i.duration=-1,o&&void 0!==o.id&&(i.id=o.id),n&&n.add(i,e,null,u,s))},e=function(){o.track.status=0,o.track.progress=0},u=function(n){o.track.status=n},s=function(n,i){o.track.progress=n,o.track.duration=i},c=function(){i.$broadcast("ionic-audio:trackChange",o.track)};this.seekTo=function(i){n.seekTo(i)},this.getTrack=function(){return o.track},this.start=function(){return o.track&&o.track.url?(n.play(o.track.id),r.hasOwnProgressBar||c(),o.track.id):void 0};var l=o.$watch("track",function(i,o){void 0!==i&&(n.stop(),a(i,o))});o.$on("$destroy",function(){l(),n.destroy()})}return{transclude:!0,template:"<ng-transclude></ng-transclude>",restrict:"E",scope:{track:"=",togglePlayback:"="},require:"ionAudioTrack",link:o,controller:["$scope","$element",t]}}function ionAudioProgress(){return{restrict:"E",scope:{track:"="},template:"{{track.progress | time}}"}}function ionAudioProgressBar(n){function i(i,o,t){function r(){i.track.progress=0,i.track.status=0,i.track.duration=-1}var a,e=o.find("input");angular.isDefined(t.displayTime)||(o.find("ion-audio-progress").remove(),o.find("ion-audio-duration").remove()),angular.isDefined(t.displayInfo)||o.find("h2").remove(),angular.isUndefined(i.track)&&(i.track={},a=i.$on("ionic-audio:trackChange",function(n,o){i.track=o}));var u=i.$watch("track.status",function(n){e.prop("disabled",0==n)});i.displayTrackInfo=function(){return{visibility:angular.isDefined(t.displayInfo)&&(i.track.title||i.track.artist)?"visible":"hidden"}},i.sliderRelease=function(){var o=i.track.progress;n.seekTo(o)},i.$on("$destroy",function(){u(),angular.isDefined(a)&&a()}),r()}return{restrict:"E",scope:{track:"="},template:'<h2 class="ion-audio-track-info" ng-style="displayTrackInfo()">{{track.title}} - {{track.artist}}</h2><div class="range"><ion-audio-progress track="track"></ion-audio-progress><input type="range" name="volume" min="0" max="{{track.duration}}" ng-model="track.progress" on-release="sliderRelease()" disabled><ion-audio-duration track="track"></ion-audio-duration></div>',link:i}}function ionAudioPlay(n,i){function o(o,t,r,a){var e,u,s=0,c=function(){e=!1,t.addClass("ion-play"),t.removeClass("ion-pause"),t.text(r.textPlay)},l=function(){r.textPlay&&r.textPause&&t.text(t.text()==r.textPlay?r.textPause:r.textPlay)},d=function(){t.toggleClass("ion-play ion-pause"),l()};n.on("tap",function(){return u||e?void(u=!1):(0==s&&(e=!0),a.play(),void d())},t),n.on("doubletap",function(){u=!0},t);var g=o.$parent.$watch("track.status",function(n){0==n||4==n?c():2==n&&(e=!1),s=n}),f=o.$parent.$watch("togglePlayback",function(n,o){n!=o&&i(function(){d(),a.play()},300)});c(),o.$on("$destroy",function(){g(),f()})}return{restrict:"A",require:"^^ionAudioControls",link:o}}function ionAudioDuration(){return{restrict:"E",scope:{track:"="},template:"{{track.duration | duration}}"}}angular.module("ionic-audio",["ionic"]),angular.module("ionic-audio").filter("time",function(){var n=function(n){return(new Array(2).join("0")+n).slice(-2)};return function(i){i=i||0;var o=parseInt(i);return n(Math.floor(o/60))+":"+n(o%60)}}),angular.module("ionic-audio").filter("duration",["$filter",function(n){return function(i){return i>0?n("time")(i):""}}]),angular.module("ionic-audio").factory("MediaManager",["$q","$interval","$timeout","$window",function(n,i,o,t){function r(){var n=!t.cordova&&!t.Media;return console.log("ON"),n}function a(n){I=n,console.log("ionic-audio: playing track "+I.title),u(I).then(function(n){B=n,B.play(),f()},function(n){console.log("ionic-audio: failed to create media - "+n)})}function e(){console.log("ionic-audio: resuming track "+I.title),B.play(),f()}function u(i){var o=n.defer();return i.url?"function"==typeof i.url?i.url().then(function(n){i.url=n,o.resolve(new Media(n,angular.bind(i,c),angular.bind(i,l),angular.bind(i,d)))},function(n){o.reject(n)}):"string"==typeof i.url?o.resolve(new Media(i.url,angular.bind(i,c),angular.bind(i,l),angular.bind(i,d))):(console.log("ionic-audio: unrecognised track url type"),o.reject("missing track url")):(console.log("ionic-audio: missing track url"),o.reject("missing track url")),o.promise}function s(){angular.isDefined(B)&&(B.release(),B=void 0,I=void 0)}function c(){g(),s(),angular.isFunction(this.onSuccess)&&this.onSuccess()}function l(){angular.isFunction(this.onError)&&this.onError()}function d(n){this.status=n,angular.isFunction(this.onStatusChange)&&this.onStatusChange(n)}function g(){angular.isDefined(q)&&(i.cancel(q),q=void 0)}function f(){angular.isDefined(q)||I&&(q=i(function(){I.duration<0&&(I.duration=B.getDuration()),B.getCurrentPosition(function(n){n>-1&&(I.progress=n)},function(n){console.log("Error getting pos="+n)}),angular.isFunction(I.onProgress)&&I.onProgress(I.progress,I.duration)},1e3))}function p(n,i,o,t,r){return n.url?(angular.extend(n,{onSuccess:i,onError:o,onStatusChange:t,onProgress:r,status:0,duration:-1,progress:0}),n.id=z.push(n)-1,n.id):void console.log("ionic-audio: missing track url")}function k(n){if(I){if(I.id==n)return void(I.status==Media.MEDIA_RUNNING?v():e());I.id>-1&&h()}o(function(){a(z[n])},300)}function v(){console.log("ionic-audio: pausing track "+I.title),B.pause(),g()}function h(){B&&(console.log("ionic-audio: stopping track "+I.title),B.stop())}function m(n){B&&B.seekTo(1e3*n)}function y(){g(),s()}function b(n){I=n,console.log("ionic-audio: playing track "+I.title),P(I).then(function(n){B=n,B.play(),w()},function(n){console.log("ionic-audio: failed to create media - "+n)})}function $(){console.log("ionic-audio: resuming track "+I.title),B.play(),w()}function P(i){var o=n.defer();if(i.url)if("function"==typeof i.url)i.url().then(function(n){i.url=n;var t=new buzz.sound(n);t.bind("loadstart",angular.bind(i,D,1)).bind("playing",angular.bind(i,D,2)).bind("pause",angular.bind(i,D,3)).bind("error",C),o.resolve(t)},function(n){o.reject(n)});else if("string"==typeof i.url){var t=new buzz.sound(i.url);t.bind("loadstart",angular.bind(i,D,1)).bind("playing",angular.bind(i,D,2)).bind("pause",angular.bind(i,D,3)).bind("error",C),o.resolve(t)}else console.log("ionic-audio: unrecognised track url type"),o.reject("missing track url");else console.log("ionic-audio: missing track url"),o.reject("missing track url");return o.promise}function A(){angular.isDefined(B)&&(B.unbind("loadstart loadeddata playing pause progress durationchange timeupdate error"),B=void 0,I=void 0)}function C(){angular.isFunction(this.onError)&&this.onError()}function D(n){this.status=n,angular.isFunction(this.onStatusChange)&&this.onStatusChange(n)}function T(){angular.isDefined(q)&&(i.cancel(q),q=void 0)}function w(){angular.isDefined(q)||I&&(q=i(function(){I.duration<0&&(I.duration=B.getDuration()),I.progress=B.getTime(),angular.isFunction(I.onProgress)&&I.onProgress(I.progress,I.duration)},1e3))}function S(n,i,o,t,r){return n.url?(angular.extend(n,{onSuccess:i,onError:o,onStatusChange:t,onProgress:r,status:0,duration:-1,progress:0}),n.id=z.push(n)-1,n.id):void console.log("ionic-audio: missing track url")}function E(n){if(I){if(I.id==n)return void(2==I.status?x():$());I.id>-1&&M()}o(function(){b(z[n])},300)}function x(){console.log("ionic-audio: pausing track "+I.title),B.pause(),T()}function M(){B&&(console.log("ionic-audio: stopping track "+I.title),B.pause(),T())}function j(n){B&&B.setTime(n)}function F(){T(),A()}var I,B,q,z=[];return{add:r()?S:p,play:r()?E:k,pause:r()?x:v,stop:r()?M:h,seekTo:r()?j:m,destroy:r()?F:y}}]),angular.module("ionic-audio").directive("ionAudioTrack",["MediaManager","$rootScope",ionAudioTrack]),angular.module("ionic-audio").directive("ionAudioProgress",ionAudioProgress),angular.module("ionic-audio").directive("ionAudioProgressBar",["MediaManager",ionAudioProgressBar]),angular.module("ionic-audio").directive("ionAudioPlay",["$ionicGesture","$timeout",ionAudioPlay]),angular.module("ionic-audio").directive("ionAudioDuration",ionAudioDuration),angular.module("ionic-audio").directive("ionAudioControls",function(){function n(n,i){var o,t=i.find("ion-spinner"),r=this;t.addClass("ng-hide"),this.toggleSpinner=function(){t.toggleClass("ng-hide")},this.play=function(){o||r.toggleSpinner(),this.start()};var a=n.$parent.$watch("track.status",function(n){switch(n){case 1:o=!1;break;case 2:o||(r.toggleSpinner(),o=!0);break;case 0:case 4:o=!1}});n.$on("$destroy",function(){a()})}function i(n,i,o,t){t[0].start=t[1].start}return{restrict:"EA",require:["ionAudioControls","^^ionAudioTrack"],controller:["$scope","$element",n],link:i}});